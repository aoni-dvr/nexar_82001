ifndef QCONFIG
QCONFIG=qconfig.mk
endif
include $(QCONFIG)

include $(MKFILES_ROOT)/qmacros.mk
-include $(PROJECT_ROOT)/roots.mk

#
# This works around an optimizer bug in the (Patch B) compiler
# This should be fixed in QNX 6.1
#
	CCFLAGS_a29f004_sync_sh += -O0
	CCFLAGS_aCFI_ident_sh += -O0
	CCFLAGS_iCFI_ident_sh += -O0

	CCFLAGS += $(CCF_$(COMPILER_TYPE)_$(COMPILER_DRIVER)) \
	        $(CCFLAGS_$(SECTION))   \
	        $(CCFLAGS_$(COMPILER_TYPE)_$(CPU)) \
	        $(CCFLAGS_$(CPU))   \
	        $(CCFLAGS_$(basename $@)) \
	        $(CCFLAGS_$(basename $@)_$(CPU))\
	        -DF3S_VER=3

ROOT_PATTERNS := $(dir $(wildcard ../../*/.))
CPU_PATTERNS := $(dir $(wildcard ../../*/Makefile))

EXTRA_SRCVPATH = $(filter-out $(CPU_PATTERNS), $(ROOT_PATTERNS))
EXTRA_INCVPATH += $(PROJECT_ROOT)/../../../../../../vendors/ambarella/inc
EXTRA_INCVPATH += $(PROJECT_ROOT)/../../../../../../vendors/ambarella/inc/io
EXTRA_INCVPATH += $(PROJECT_ROOT)/../../../../../../vendors/ambarella/inc/io/$(AMBA_CHIP_ID)
EXTRA_INCVPATH += $(PROJECT_ROOT)/../../../../src/$(AMBA_CHIP_ID)/inc
EXTRA_INCVPATH += $(PROJECT_ROOT)/../../../../src/$(AMBA_CHIP_ID)/inc/csl
EXTRA_INCVPATH += $(PROJECT_ROOT)/../../../../src/$(AMBA_CHIP_ID)/inc/rtsl
EXTRA_INCVPATH += $(PROJECT_ROOT)/../../../../src/$(AMBA_CHIP_ID)/inc/reg
EXTRA_INCVPATH += $(PROJECT_ROOT)/../../../../src/$(AMBA_CHIP_ID)/inc/reg/debugport
EXTRA_INCVPATH += $(PROJECT_ROOT)/../../../../src/$(AMBA_CHIP_ID)/inc/qnx_public

define PINFO
PINFO DESCRIPTION=ambarella mtd-flash Driver
endef

NAME := mtd-flash
USEFILE = $(PROJECT_ROOT)/Usemsg
INSTALLDIR = sbin
LIBS =  drvrS kal-ambarella


#####AUTO-GENERATED by packaging script... do not checkin#####
   INSTALL_ROOT_nto = $(PROJECT_ROOT)/../../../../../../install
   USE_INSTALL_ROOT=1
##############################################################

include $(MKFILES_ROOT)/qtargets.mk

